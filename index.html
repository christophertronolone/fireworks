<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Fireworks Generator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Ensures HTML and Body take up the full viewport */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrolling */
        }
        
        /* Custom styles to ensure the canvas covers the full content area */
        #fireworks-canvas {
            display: block;
            width: 100%;
            height: 100%;
            background-color: #0b0c10; /* Very dark background for sky */
            cursor: crosshair;
        }

        /* Set Inter font */
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <!-- Canvas Container (Fills the entire screen) -->
    <div id="canvas-container" class="fixed inset-0 w-full h-full">
        <canvas id="fireworks-canvas"></canvas>
    </div>

    <!-- Title and Instructions (Floats over the canvas) -->
    <div class="fixed top-4 left-1/2 transform -translate-x-1/2 z-20 text-center bg-gray-800/70 p-4 rounded-xl shadow-2xl border border-gray-700 max-w-lg w-full md:max-w-md">
        <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-red-500 mb-1">
            ðŸŽ† Fireworks Simulator
        </h1>
        <p class="text-sm text-gray-300">
            Click or tap anywhere on the dark screen to launch a new firework!
        </p>
    </div>

    <script>
        // --- Setup and Initialization ---
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');
        const FIREWORKS = [];
        const PARTICLES = [];
        const GRAVITY = 0.05;
        const FRICTION = 0.95;
        const COLORS = ['#ff4500', '#ffd700', '#00ff7f', '#1e90ff', '#ff69b4', '#9370db', '#adff2f'];

        // Helper function for random numbers
        const random = (min, max) => Math.random() * (max - min) + min;

        // Helper function to get a random color
        const randomColor = () => COLORS[Math.floor(random(0, COLORS.length))];

        // Ensure canvas is resized to fill its container
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }

        // We call resize immediately and listen for load/resize events
        resizeCanvas();
        window.addEventListener('load', () => {
            // Start the main loop after load
            animate();
        });
        window.addEventListener('resize', resizeCanvas);


        // --- Particle Class (Spark) ---
        class Particle {
            constructor(x, y, color, velocity, isRocket = false) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.vx = velocity.x;
                this.vy = velocity.y;
                this.alpha = 1;
                this.radius = isRocket ? 2 : random(1, 3);
                this.isRocket = isRocket;
                this.decay = random(0.01, 0.03); // How fast alpha decreases
            }

            update() {
                // Apply friction and gravity
                if (!this.isRocket) {
                    this.vx *= FRICTION;
                    this.vy *= FRICTION;
                    this.vy += GRAVITY;
                }

                // Update position
                this.x += this.vx;
                this.y += this.vy;

                // Fade out
                this.alpha -= this.decay;
                if (this.alpha < 0) this.alpha = 0;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        // --- Firework Class (Rocket) ---
        class Firework {
            constructor(targetX, targetY) {
                this.targetX = targetX;
                this.targetY = targetY;
                this.x = canvas.width / 2; // Start from the bottom center
                this.y = canvas.height;
                this.exploded = false;
                this.color = randomColor();

                // Calculate velocity to reach target
                const angle = Math.atan2(targetY - this.y, targetX - this.x);
                const speed = random(10, 15);
                this.rocket = new Particle(
                    this.x,
                    this.y,
                    this.color,
                    { x: Math.cos(angle) * speed, y: Math.sin(angle) * speed },
                    true // isRocket
                );
            }

            update() {
                if (this.exploded) return;

                this.rocket.update();

                // Check if the rocket has passed the target or reached its peak
                const distToTarget = Math.hypot(this.targetX - this.rocket.x, this.targetY - this.rocket.y);
                const distFromOrigin = Math.hypot(this.x - this.rocket.x, this.y - this.rocket.y);
                const totalDist = Math.hypot(this.targetX - this.x, this.targetY - this.y);

                if (distToTarget < 20 || this.rocket.vy > 0 && distFromOrigin > totalDist * 0.8) {
                    this.explode();
                    this.exploded = true;
                }
            }

            draw() {
                if (!this.exploded) {
                    this.rocket.draw();
                }
            }

            explode() {
                const count = 100; // Number of sparks
                for (let i = 0; i < count; i++) {
                    const angle = random(0, Math.PI * 2);
                    const speed = random(0.5, 7);
                    const velocity = {
                        x: Math.cos(angle) * speed,
                        y: Math.sin(angle) * speed
                    };

                    PARTICLES.push(new Particle(this.rocket.x, this.rocket.y, this.color, velocity));
                }
            }
        }


        // --- Main Animation Loop ---
        function animate() {
            requestAnimationFrame(animate);

            // Create a transparent rectangle to fade out the previous frame's drawing (creates a nice trail effect)
            ctx.fillStyle = 'rgba(11, 12, 16, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Update and Draw Fireworks
            for (let i = FIREWORKS.length - 1; i >= 0; i--) {
                const firework = FIREWORKS[i];
                firework.update();
                firework.draw();

                // Remove finished fireworks (once exploded)
                if (firework.exploded) {
                    // Remove the firework instance to clean up memory
                    FIREWORKS.splice(i, 1);
                }
            }

            // Update and Draw Particles
            for (let i = PARTICLES.length - 1; i >= 0; i--) {
                const particle = PARTICLES[i];
                particle.update();
                particle.draw();

                // Remove faded particles
                if (particle.alpha <= 0) {
                    PARTICLES.splice(i, 1);
                }
            }
        }

        // --- Event Handlers ---
        function launchFirework(event) {
            let x, y;

            if (event.touches && event.touches.length > 0) {
                // Touch event
                const rect = canvas.getBoundingClientRect();
                x = event.touches[0].clientX - rect.left;
                y = event.touches[0].clientY - rect.top;
            } else {
                // Mouse event
                x = event.offsetX;
                y = event.offsetY;
            }

            // Only launch if the target is in the upper half of the screen
            // to ensure rockets have space to fly up.
            if (y < canvas.height * 0.95) {
                 FIREWORKS.push(new Firework(x, y));
            }
        }

        canvas.addEventListener('click', launchFirework);
        canvas.addEventListener('touchstart', launchFirework, { passive: true });

    </script>
</body>
</html>
